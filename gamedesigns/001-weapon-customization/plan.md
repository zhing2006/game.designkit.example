# 设计计划：枪匠系统（武器定制）

**分支**：`001-weapon-customization` | **日期**：2025-11-14 | **规范**：[spec.md](./spec.md)
**输入**：来自 `/gamedesigns/001-weapon-customization/spec.md` 的游戏规范

**注意**：此文档由 `/game.designkit.plan` 命令生成。有关执行工作流程，请参见 `.game.design/templates/commands/plan.md`。

## 摘要

《归途》的枪匠系统是一个武器定制功能，允许玩家通过安装组件（枪口、瞄具、弹匣、握把、附件、枪托）来改造武器性能，并通过涂装系统进行视觉定制。系统设计包含6个核心槽位、品质分级系统（白<绿<蓝<紫<金）、配置管理功能和阵营专属内容。本计划将产出系统策划文档、流程说明、组件配置表和涂装配置表，确保设计符合"屯积的正反馈快感"和"可接近的硬核体验"设计支柱。

**用户特定需求**：
- 系统策划文档：完整的枪匠系统设计
- 武器改造流程说明文档：玩家操作流程指南
- 组件配置文件：包含ID、名称、品质、槽位、属性1-5、描述（属性可正可负）
- 涂装配置文件：包含ID、名称、品质、美术材质ID、描述

## 设计上下文

**Game Type/Genre**: 硬核提取射击（Extraction Shooter）+ 生存
**Target Platform**: PC（Steam）和主机（PS5/Xbox Series）
**Design Method**: 系统设计（武器改造系统）+ 数值设计（组件属性平衡）+ 配置设计（数据表结构）
**Dependent Specs**: 000-game-vision（核心玩法循环、物资品质系统、硬核射击体验、世界观设定）
**Reference Games**:
- 《逃离塔科夫》（枪械改装系统深度）
- 《使命召唤：现代战争》（5槽位枪匠系统、预设配置）
- 《彩虹六号：围攻》（配件影响玩法）
- 《CS:GO》（皮肤系统）
**Spec Type**: 功能型（001-weapon-customization）
**Experience Goals**:
- 收集满足感（"屯屯鼠"快感）
- 个性化表达（"这是我的枪"）
- 战术深度（不同场景需要不同配置）
- 渐进式成长（白色基础→金色传说）
**Design Constraints**:
- 6个核心槽位，不同武器类型有不同槽位配置
- 每槽位3-8个组件选择
- 品质由性能决定（非磨损度）
- 仅在安全区可改造（跨局准备）
- 组件和涂装通过游戏内玩法获得（无氪金优势）
**Scale/Scope**:
- 6个组件槽位 × 5个品质等级 × 平均5个组件/槽位 = 约150个组件
- 5个用户故事（2个P1、2个P2、1个P3）
- 3个阵营专属组件系列
- 涂装数量待数值设计确定

## 章程检查

*门限：必须在第 0 阶段研究之前通过。在第 1 阶段设计后重新检查。*

### 设计支柱符合性检查

| 设计支柱 | 检查项 | 状态 | 说明 |
|---------|-------|------|------|
| **支柱1：保证撤离的良性循环** | 枪匠系统是否影响撤离机制？ | ✅ 通过 | 枪匠系统不影响撤离机制，仅在安全区提供装备优化，支持玩家技巧成长 |
| **支柱2：屯积的正反馈快感** | 组件和涂装是否提供清晰的积累快感？ | ✅ 通过 | 品质分级系统、蓝光特效、库存可视化直接服务于"屯屯鼠"体验 |
| **支柱3：电影级视觉震撼** | 枪匠系统是否支持视觉表现？ | ✅ 通过 | 3D旋转展示、组件可视化、涂装系统提供高品质视觉反馈 |
| **支柱4：可接近的硬核体验** | 系统是否平衡深度和可接近性？ | ✅ 通过 | 预设配置降低新手门槛，6槽位提供深度，避免《塔科夫》式复杂度 |

### 质量标准检查

| 质量标准 | 目标值 | 当前设计 | 状态 |
|---------|-------|---------|------|
| 物资正反馈 | 每次3-5件有价值物品 | 组件作为搜刮物品，每局可获得多个组件 | ✅ 符合 |
| 难度平衡 | 新手3-5次理解机制 | 预设配置、系统推荐、渐进式引导 | ✅ 符合 |
| 枪械手感 | 真实后坐力和弹道 | 组件属性直接影响后坐力、精准度等射击手感 | ✅ 符合 |

### 章程检查结论

✅ **全部通过** - 本设计计划符合所有设计支柱和质量标准要求，无违规项，可以进入Phase 0研究阶段。

## 项目结构

### 文档（此功能）

```
gamedesigns/001-weapon-customization/
├── plan.md              # 此文件（/game.designkit.plan 命令输出）
├── research.md          # Phase 0 输出（设计决策研究）
├── quickstart.md        # Phase 1 输出（快速开始指南）
├── checklists/          # 质量检查清单
│   ├── requirements.md  # 已存在（规范质量检查）
│   └── plan-quality.md  # Phase 2 输出（计划质量检查）
└── tasks.md             # Phase 2 输出（/game.designkit.tasks 命令）
```

### 设计产物结构（仓库根目录）

```
docs/weapon-customization/           # 策划案输出目录
├── gunsmith-system-design.md       # 系统策划文档（核心文档）
├── weapon-modification-flow.md     # 武器改造流程说明文档
├── component-config.csv            # 组件配置表（数据文件）
└── skin-config.csv                 # 涂装配置表（数据文件）

gamedesigns/001-weapon-customization/
├── spec.md              # 游戏规范（输入）
├── plan.md              # 设计方案（本文件）
├── research.md          # 设计决策研究
├── quickstart.md        # 快速开始指南
└── checklists/          # 质量检查清单
    ├── requirements.md  # 规范质量检查
    └── plan-quality.md  # 计划质量检查
```

**结构说明**：
- **docs/weapon-customization/** 目录存放最终策划案产物（供其他团队成员阅读）
- **gamedesigns/001-weapon-customization/** 目录存放设计过程文档（设计师工作区）
- 配置文件使用CSV格式，便于导入游戏引擎和数值调整

## 复杂度跟踪

> **仅当章程检查有必须证明的违规时才填写**

本设计无章程违规项，此部分留空。

---

## 设计产物清单

**规范类型识别**：本规范为**功能型规范（001-weapon-customization）**，关注具体功能系统的设计、数值平衡和配置实现。

根据 spec.md 内容分析和用户特定需求，本计划识别出以下**设计产物**：

### 核心设计文档

1. **gunsmith-system-design.md** - 枪匠系统策划文档
   - **识别依据**：spec.md 包含完整的系统需求（FR-001至FR-011）、用户故事（5个）、关键实体定义
   - **目的**：完整描述枪匠系统的设计方案，包括系统架构、玩法机制、UI/UX设计、数值框架
   - **核心内容**：
     - **系统概述**：功能定位、设计目标、核心体验
     - **槽位系统**：6个核心槽位定义、不同武器类型的槽位配置矩阵
     - **组件系统**：组件分类、品质分级、属性设计原则、兼容性规则
     - **涂装系统**：涂装分类、品质分级、视觉设计方向
     - **配置管理**：预设配置、自定义配置、快速切换机制
     - **阵营专属内容**：三大阵营的组件特色、枪匠NPC、委托任务
     - **数值框架**：属性权衡原则、品质递进曲线、平衡性验证方法
     - **UI/UX设计**：工作台界面布局、操作流程、视觉反馈
   - **内容来源**：spec.md 全文 + research.md（Phase 0产出）
   - **输出路径**：`docs/weapon-customization/gunsmith-system-design.md`

2. **weapon-modification-flow.md** - 武器改造流程说明文档
   - **识别依据**：spec.md 用户故事1（基础组件改造流程）明确定义了完整操作流程，用户明确要求此文档
   - **目的**：为玩家和开发团队提供清晰的武器改造操作指南，确保流程流畅且易于理解
   - **核心内容**：
     - **流程概览**：改造流程图（进入工作台 → 选择武器 → 浏览组件 → 预览效果 → 确认改造）
     - **详细步骤**：
       1. 进入枪匠工作台（位置、前置条件）
       2. 选择武器（筛选、排序、当前配置显示）
       3. 浏览组件（槽位选择、组件列表、属性对比）
       4. 安装/替换/移除组件（操作方式、兼容性检查）
       5. 预览效果（属性雷达图、3D模型、数值对比）
       6. 保存配置（命名、配置槽位管理）
       7. 确认改造（资源消耗检查、最终确认）
     - **特殊流程**：
       - 配置快速切换流程
       - 涂装应用流程
       - 系统推荐配置应用流程
     - **错误处理**：兼容性冲突、库存不足、误操作撤销
     - **新手引导**：首次使用提示、关键操作高亮
   - **内容来源**：spec.md 用户故事1、FR-004、FR-006、FR-007 + research.md（UX最佳实践）
   - **输出路径**：`docs/weapon-customization/weapon-modification-flow.md`

### 配置数据文件

3. **component-config.csv** - 组件配置表
   - **识别依据**：用户明确要求，spec.md FR-002定义了组件品质和属性系统
   - **目的**：定义所有可用组件的数据配置，供游戏引擎读取和数值平衡调整
   - **表结构**（必需列）：

     | 列名 | 数据类型 | 说明 | 示例 |
     |------|---------|------|------|
     | ID | String | 组件唯一标识符 | `COMP_GRIP_001` |
     | 名称 | String | 组件显示名称 | `战术前握把` |
     | 品质 | Enum | 品质等级（White/Green/Blue/Purple/Gold） | `Blue` |
     | 槽位 | Enum | 所属槽位（Muzzle/Sight/Magazine/Grip/Attachment/Stock） | `Grip` |
     | 属性1 | String | 属性名:数值（正向或负向） | `后坐力控制:+12%` |
     | 属性2 | String | 属性名:数值（可选） | `机动性:-5%` |
     | 属性3 | String | 属性名:数值（可选） | `` |
     | 属性4 | String | 属性名:数值（可选） | `` |
     | 属性5 | String | 属性名:数值（可选） | `` |
     | 描述 | String | 组件描述文本 | `人体工学设计的战术握把，有效降低后坐力，但略微增加武器重量。` |
     | 美术资源ID | String | 3D模型资源ID | `MESH_GRIP_TACTICAL_01` |

   - **额外推荐列**（便于后续扩展）：
     - `阵营专属` (String)：所属阵营（Order/Wildcard/Dawn/None）
     - `解锁条件` (String)：解锁条件描述
     - `获取途径` (String)：主要获取方式（Loot/Quest/Trade）
     - `兼容性标签` (String)：兼容性分组标签（如需要导轨的瞄具标记为`RequiresRail`）

   - **数据量估算**：
     - 枪口：5品质 × 4组件 = 20个
     - 瞄具：5品质 × 6组件 = 30个
     - 弹匣：5品质 × 4组件 = 20个
     - 握把：5品质 × 5组件 = 25个
     - 附件：5品质 × 5组件 = 25个
     - 枪托：5品质 × 4组件 = 20个
     - **总计**：约140-150个组件

   - **内容来源**：spec.md FR-002（品质示例）+ research.md（数值平衡研究）
   - **输出路径**：`docs/weapon-customization/component-config.csv`

4. **skin-config.csv** - 涂装配置表
   - **识别依据**：用户明确要求，spec.md FR-005定义了涂装系统
   - **目的**：定义所有可用涂装的数据配置，纯美观不影响数值
   - **表结构**（必需列）：

     | 列名 | 数据类型 | 说明 | 示例 |
     |------|---------|------|------|
     | ID | String | 涂装唯一标识符 | `SKIN_AK_001` |
     | 名称 | String | 涂装显示名称 | `荒野烈焰` |
     | 品质 | Enum | 品质等级（White/Green/Blue/Purple/Gold） | `Purple` |
     | 美术材质ID | String | 美术材质资源ID | `MAT_AK_WILDFIRE_01` |
     | 描述 | String | 涂装描述文本 | `荒野猎人阵营的标志性涂装，红黄渐变色象征末世中不灭的火焰。` |

   - **额外推荐列**（便于后续扩展）：
     - `适用武器类型` (String)：适用武器分类（如`Rifle`, `Pistol`, `All`）
     - `阵营专属` (String)：所属阵营（Order/Wildcard/Dawn/None）
     - `解锁条件` (String)：解锁条件描述
     - `获取途径` (String)：主要获取方式（Loot/Quest/Trade/Event）
     - `特效标签` (String)：特殊视觉效果（如`Holographic`, `Glowing`, `None`）

   - **数据量估算**：
     - 白色/绿色：每武器类型2-3个 × 6类武器 = 约15个
     - 蓝色：每武器类型3-4个 × 6类武器 = 约20个
     - 紫色：每武器类型2-3个 × 6类武器 = 约15个
     - 金色/传说：每武器类型1-2个 × 6类武器 = 约10个
     - **总计**：约60-80个涂装（MVP阶段）

   - **内容来源**：spec.md FR-005、美术/音效方向 + research.md（涂装设计参考）
   - **输出路径**：`docs/weapon-customization/skin-config.csv`

### 设计产物输出顺序

**Phase 0: 研究与设计决策（plan 命令内部步骤1）**：
- ✅ research.md（设计决策研究，已完成）

**Phase 1: 产物规划（plan 命令内部步骤2）**：
- ✅ plan.md（设计计划，包含产物清单定义，已完成）
- ✅ quickstart.md（快速开始指南，已完成）
- ✅ checklists/plan-quality.md（计划质量检查，已完成）

**Phase 2: 任务分解（tasks 命令阶段）**：
- ✅ tasks.md（任务分解清单，已完成）

**Phase 3: 策划案编写（implement 命令阶段）**：
- ⏭️ gunsmith-system-design.md（系统策划文档）
- ⏭️ weapon-modification-flow.md（流程说明文档）
- ⏭️ component-config.csv（组件配置表）
- ⏭️ skin-config.csv（涂装配置表）

**重要说明**：
- **plan 命令（Phase 0-1）**：研究决策 + 产物规划（在 plan.md 中定义需要哪些文档，不实际生成）
- **tasks 命令（Phase 2）**：生成任务清单，定义如何编写策划案
- **implement 命令（Phase 3）**：执行任务，实际编写策划案文档和配置表

---

## 设计支柱对齐验证

根据 `.game.design/memory/pillars.md` 定义的设计支柱，验证本设计方案的对齐情况：

| 设计支柱 | 本设计的体现 | 对齐度 | 潜在冲突 |
|---------|------------|-------|---------|
| **支柱1：保证撤离的良性循环** | • 枪匠系统不干扰撤离机制<br>• 组件存储在安全区，死亡不丢失<br>• 支持玩家技巧成长（通过配置优化提升撤离成功率） | ✅ 完全对齐 | 无 |
| **支柱2：屯积的正反馈快感** | • 组件和涂装作为搜刮物品，丰富积累体验<br>• 品质分级系统（白<绿<蓝<紫<金）创造"开箱"般期待<br>• 蓝光特效、库存可视化强化满足感<br>• 配置保存系统让玩家看到"选择权"增长 | ✅ 完全对齐 | 无 |
| **支柱3：电影级视觉震撼** | • 3D旋转展示、高品质组件模型<br>• 涂装系统提供视觉定制<br>• 工作台氛围设计（工业风格、光影效果）<br>• 组件安装动画、属性雷达图可视化 | ✅ 完全对齐 | 无 |
| **支柱4：可接近的硬核体验** | • 预设配置降低新手门槛（"新手友好配置"）<br>• 系统推荐引导新手选择<br>• 6槽位提供深度，避免《塔科夫》过度复杂<br>• 老手可追求高风险高回报配置<br>• 渐进式成长路径（白色基础→金色传说） | ✅ 完全对齐 | 无 |

### 对齐度详细分析

#### 支柱1：保证撤离的良性循环

**体现方式**：
- 枪匠系统作为"跨局准备"功能，在安全区提供装备优化
- 组件库存独立于携带武器，死亡不丢失，保证"东山再起"路径
- 通过配置优化提升战斗效率，间接支持玩家技巧成长和撤离成功率

**对齐结论**：✅ 完全对齐，枪匠系统不干扰核心"搜-打-撤"循环，反而通过装备优化支持良性循环。

---

#### 支柱2：屯积的正反馈快感

**体现方式**：
- 组件和涂装作为有价值的搜刮物品，丰富"屯屯鼠"体验
- 品质分级系统创造"开箱"般的期待感和惊喜感
- 蓝光特效、"新物品"标记提供即时正反馈
- 配置保存系统让玩家看到"选择权"和"仓库帝国"不断扩张

**对齐结论**：✅ 完全对齐，枪匠系统是"屯积快感"设计支柱的直接体现。

---

#### 支柱3：电影级视觉震撼

**体现方式**：
- 3D旋转展示、高细节组件模型利用UE5 Nanite技术
- 涂装系统提供金色传说级别的动态效果（全息图案、发光细节）
- 工作台界面的工业风格、昏黄灯光营造末世氛围
- 组件安装动画、属性雷达图提供流畅的视觉反馈

**对齐结论**：✅ 完全对齐，枪匠系统通过高品质UI/UX和涂装系统支持视觉震撼体验。

---

#### 支柱4：可接近的硬核体验

**体现方式**：
- 预设配置（"新手友好配置"、"远程精准配置"等）降低新手门槛
- 系统推荐组件引导新手选择，避免选择困难
- 6槽位设计保留深度（每槽位3-8选择），但不像《塔科夫》那样需要导轨转接件
- 老手可以追求高风险高回报配置（如高伤害但高后坐力）
- 渐进式成长路径（白色→金色）提供清晰的进度感

**对齐结论**：✅ 完全对齐，枪匠系统在深度和可接近性之间取得平衡，符合"广泛受众"定位。

---

### 总体对齐结论

✅ **完全对齐，无需调整**

本设计计划在所有四个设计支柱上均实现完全对齐，无潜在冲突。枪匠系统作为核心功能之一，充分体现了"屯积的正反馈快感"和"可接近的硬核体验"设计支柱，同时不干扰"保证撤离的良性循环"，并通过高品质UI/UX支持"电影级视觉震撼"。后续设计产物应继续遵循这些设计支柱，确保最终实现符合《归途》的核心愿景。

---

## Phase 0: 研究与设计决策

**目标**：完成设计前的关键决策研究，为产物规划提供依据

本阶段研究以下关键设计决策点：

### 研究任务清单

1. **组件数值平衡方法论**
   - 研究问题：如何设计组件属性权衡，确保高品质组件有优势但不破坏平衡？
   - 参考游戏：《逃离塔科夫》（真实权衡）、《使命召唤》（可视化对比）
   - 输出：数值权衡原则、品质递进公式

2. **槽位兼容性规则**
   - 研究问题：如何设计兼容性检查，在避免过度复杂的同时保留真实感？
   - 参考游戏：《逃离塔科夫》（高复杂度）、《使命召唤》（简化兼容性）
   - 输出：兼容性规则最佳实践、错误提示设计

3. **配置管理UX最佳实践**
   - 研究问题：如何设计配置切换流程，让老手高效切换、新手也能理解？
   - 参考游戏：《使命召唤》（预设配置）、《彩虹六号》（装备方案保存）
   - 输出：配置管理UI布局、操作流程图

4. **涂装视觉设计层次**
   - 研究问题：如何通过纯视觉元素体现品质差异，让金色涂装值得追求？
   - 参考游戏：《CS:GO》（皮肤品质分级）、《Apex英雄》（传说级动态效果）
   - 输出：涂装品质视觉规范、特效设计指南

5. **阵营专属内容差异化**
   - 研究问题：如何设计三大阵营的组件特色，体现其战斗哲学差异？
   - 参考世界观：秩序同盟（精准）、荒野猎人（火力）、黎明贸易团（平衡）
   - 输出：阵营组件特色表、专属任务设计方向

6. **组件获取频率与掉落概率**
   - 研究问题：如何设计组件掉落频率，平衡"经常有收获"和"稀有惊喜"？
   - 依赖：000-game-vision的物资掉落系统、单局15-30分钟循环
   - 输出：品质掉落概率表、每局预期获取量

### Phase 0 输出文件

- ✅ `research.md` - 设计决策研究（已完成）

---

## Phase 1: 产物规划

**目标**：识别并定义需要产出的设计文档，在 plan.md 中规划产物清单（不实际生成这些产物）

**重要**：Phase 1 是在 plan.md 中**定义产物清单**（目的、结构、内容来源、输出路径），不是实际生成 gunsmith-system-design.md 等策划案文档。实际文档编写在 Phase 3（implement 命令）完成。

### Phase 1 输出文件

- ✅ `plan.md` - 设计计划（包含产物清单定义，已完成）
- ✅ `quickstart.md` - 快速开始指南（已完成）
- ✅ `checklists/plan-quality.md` - 计划质量检查清单（已完成）

---

## Phase 2: 任务分解（tasks 命令阶段）

**目标**：生成详细的任务分解清单，定义如何编写策划案文档

本阶段由 `/game.designkit.tasks` 命令执行，基于 Phase 0-1 的研究和规划生成任务清单：

### 预期任务类型

1. **编写系统策划文档任务**
   - 产出：`docs/weapon-customization/gunsmith-system-design.md`
   - 依赖：research.md 的数值平衡和UX研究

2. **编写流程说明文档任务**
   - 产出：`docs/weapon-customization/weapon-modification-flow.md`
   - 依赖：research.md 的UX最佳实践和流程图

3. **编写组件配置表任务**
   - 产出：`docs/weapon-customization/component-config.csv`
   - 依赖：gunsmith-system-design.md 的数值框架

4. **编写涂装配置表任务**
   - 产出：`docs/weapon-customization/skin-config.csv`
   - 依赖：gunsmith-system-design.md 的涂装设计规范

### Phase 2 输出文件

- ✅ `tasks.md` - 任务分解清单（已完成）

---

## Phase 3: 策划案编写（implement 命令阶段）

**目标**：执行 tasks.md 中的任务，实际编写所有策划案文档和配置表

本阶段由 `/game.designkit.implement` 命令执行，逐项完成 tasks.md 定义的编写任务：

### Phase 3 输出文件

- ⏭️ `docs/weapon-customization/gunsmith-system-design.md` - 系统策划文档
- ⏭️ `docs/weapon-customization/weapon-modification-flow.md` - 流程说明文档
- ⏭️ `docs/weapon-customization/component-config.csv` - 组件配置表（约140-150行）
- ⏭️ `docs/weapon-customization/skin-config.csv` - 涂装配置表（约60-80行）

---

## 下一步行动

### Phase 0-1 完成情况 ✅

**Phase 0（研究与设计决策）**：
- ✅ research.md - 设计决策研究（已完成）

**Phase 1（产物规划）**：
- ✅ plan.md - 设计计划，包含产物清单定义（已完成）
- ✅ quickstart.md - 快速开始指南（已完成）
- ✅ checklists/plan-quality.md - 计划质量检查（已完成）

### Phase 2 完成情况 ✅

**Phase 2（任务分解）**：
- ✅ tasks.md - 任务分解清单（已完成）

### Phase 3 启动

**执行命令**：`/game.designkit.implement`

**预期输出**（实际编写策划案文档）：
1. `docs/weapon-customization/gunsmith-system-design.md` - 系统策划文档
2. `docs/weapon-customization/weapon-modification-flow.md` - 流程说明文档
3. `docs/weapon-customization/component-config.csv` - 组件配置表（约140-150行）
4. `docs/weapon-customization/skin-config.csv` - 涂装配置表（约60-80行）

**阶段说明**：
- **Phase 0-1（plan 命令）**：✅ 已完成，研究决策 + 产物规划
- **Phase 2（tasks 命令）**：✅ 已完成，任务分解清单
- **Phase 3（implement 命令）**：⏭️ 待执行，实际编写策划案文档

---

**版本**：1.0.0
**创建日期**：2025-11-14
**最后更新**：2025-11-14
